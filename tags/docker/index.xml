<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>Docker - Tag - chengleqi's blog</title><link>https://chengleqi.com/tags/docker/</link><description>Docker - Tag - chengleqi's blog</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Sun, 01 Aug 2021 21:08:29 +0800</lastBuildDate><atom:link href="https://chengleqi.com/tags/docker/" rel="self" type="application/rss+xml"/><item><title>Docker+GitHub Actions优化博客workflow</title><link>https://chengleqi.com/posts/hugo/</link><pubDate>Sun, 01 Aug 2021 21:08:29 +0800</pubDate><guid>https://chengleqi.com/posts/hugo/</guid><description><![CDATA[<div class="featured-image">
                <img src="https://d33wubrfki0l68.cloudfront.net/c38c7334cc3f23585738e40334284fddcaf03d5e/2e17c/images/hugo-logo-wide.svg" referrerpolicy="no-referrer">
            </div>效果 在vscode中写作，写完直接commit push，完成文章的发布。
workflow 如下图:
 上图是用mermaid画的，flowchart是mermaid高版本的feature，在我使用Feelit主题shortcode的时候还没有得到支持，提了个issue，在这次更新中得到了支持。
使用Docker进行本地预览 参考了jojomi/docker-hugo重写了Dockerfile和构建镜像并且启动容器的脚本chengleqi/docker-hugo。
镜像的README   先在浏览器中下载最新版hugo binary(extend版本) 将下载好的hugo binary放在项目根目录 执行./build_and_start_hugo.sh 构建镜像并运行容器 打开浏览器 localhost:1313     Note  在docker run的时候挂载了blog目录用于hugo server，并添加了--rm参数，退出容器后直接删除容器。   使用GitHub Actions自动构建并部署 此处参考了Arnab Kumar Shil的文章。配置了GitHub Actions的流水线。脚本如下:
name:github pageson:push:branches:- main # Set a branch to deploypull_request:jobs:deploy:runs-on:ubuntu-20.04steps:- uses:actions/checkout@v2with:submodules:true# Fetch Hugo themes (true OR recursive)fetch-depth:0# Fetch all history for .GitInfo and .Lastmod- name:Setup Hugouses:peaceiris/actions-hugo@v2with:hugo-version:&#39;latest&#39;extended:true- name:Buildrun:hugo --minify- name:Deployuses:peaceiris/actions-gh-pages@v3if:github.ref == &#39;refs/heads/main&#39;with:personal_token:${{ secrets.ACTION_ACCESS_TOKEN }}external_repository:chengleqi/chengleqi.github.iopublish_branch:mainpublish_dir:./publiccname:chengleqi.com这个脚本使用了peaceiris/actions-hugo@v2和peaceiris/actions-gh-pages@v3两个action分别用于设置hugo环境以及推送至gh-pages。
Tip   存储blog源文件的repo访问github.]]></description></item></channel></rss>