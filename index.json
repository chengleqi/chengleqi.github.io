[{"categories":["Kubernetes"],"content":"ä½¿ç”¨kindåˆ›å»ºé›†ç¾¤ å®‰è£…å¥½kindåç›´æ¥kind create cluster --config config.yaml --name clusterå¯åŠ¨é›†ç¾¤ï¼Œconfig.yamlå¦‚ä¸‹ï¼Œæ˜¯ä¸€ä¸ªæœ‰ä¸€ä¸ªmasterä¸¤ä¸ªnodeçš„æµ‹è¯•é›†ç¾¤ã€‚æµ‹è¯•å®Œæˆåkind delete cluster --name clusterå³å¯åˆ é™¤é›†ç¾¤ã€‚ # three node (two workers) cluster configkind:ClusterapiVersion:kind.x-k8s.io/v1alpha4nodes:- role:control-plane- role:worker- role:workeråœ¨å°è¯•è¿‡minikubeå’Œkindåè¿˜æ˜¯é€‰æ‹©äº†kindã€‚ ","date":"2021-08-05","objectID":"/posts/21-08-05/kube-prometheus/:1:0","tags":["Prometheus"],"title":"Kuberneteséƒ¨ç½²kube-prometheus","uri":"/posts/21-08-05/kube-prometheus/"},{"categories":["Kubernetes"],"content":"éƒ¨ç½²kube-prometheus ä¸€èˆ¬åœ¨é›†ç¾¤ä¸­éƒ¨ç½²Prometheusæœ‰ä¸‰ç§æ–¹æ³•ï¼šPrometheus Operatorã€kube-prometheus å’Œ community helm chartã€‚ éƒ¨ç½²æ–¹å¼æ¯”è¾ƒ Prometheus Operator The Prometheus Operator uses Kubernetes custom resources to simplify the deployment and configuration of Prometheus, Alertmanager, and related monitoring components. kube-prometheus kube-prometheus provides example configurations for a complete cluster monitoring stack based on Prometheus and the Prometheus Operator. This includes deployment of multiple Prometheus and Alertmanager instances, metrics exporters such as the node_exporter for gathering node metrics, scrape target configuration linking Prometheus to various metrics endpoints, and example alerting rules for notification of potential issues in the cluster. helm chart The prometheus-community/kube-prometheus-stack helm chart provides a similar feature set to kube-prometheus. This chart is maintained by the Prometheus community. For more information, please see the chartâ€™s readme kube-prometheusæä¾›äº†è®¸å¤šå¼€ç®±å³ç”¨çš„é…ç½®ï¼Œä¾‹å¦‚Alertmanagerã€node-exporterä»¥åŠGrafana dashboardsã€‚ å°†kube-prometheusé¡¹ç›®cloneè‡³æœ¬åœ°ï¼Œç„¶åæ‰§è¡Œ: # Create the namespace and CRDs, and then wait for them to be available before creating the remaining resources kubectl create -f manifests/setup until kubectl get servicemonitors --all-namespaces ; do date; sleep 1; echo \"\"; done kubectl create -f manifests/ ç”±äºåˆ›å»ºé•œåƒéœ€è¦æ‹‰å–çš„é•œåƒæ‰˜ç®¡åœ¨quay.ioï¼Œä¼šå‡ºç°ImagePullBackOffé”™è¯¯ï¼š ImagePullBackOff\" ImagePullBackOff k describe pods -n monitoring prometheus-operator-75d9b475d9-f29g8æ£€æŸ¥ä¸€ä¸‹ï¼Œæ˜¯ quay.io/brancz/kube-rbac-proxy:v0.11.0 quay.io/prometheus-operator/prometheus-operator:v0.49.0 ä¸¤ä¸ªé•œåƒæ‹‰å–å¤±è´¥ï¼Œè¿™æ—¶å€ŸåŠ©é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡è¿›è¡Œæ‹‰å–ã€‚ é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡æ„å»ºé•œåƒæ­¥éª¤ åˆ›å»ºGitHub repoï¼Œè·¯å¾„æ ¼å¼ä¸ºï¼šimage-name/tag/Dockerfile åœ¨é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ä¸­åˆ›å»ºä»“åº“image-name é€‰æ‹©ä»£ç æºä¸ºGitHub repoï¼Œé€‰æ‹©æµ·å¤–æ„å»º è¿›å…¥ä»“åº“ï¼Œæ·»åŠ æ„å»ºè§„åˆ™ï¼Œç«‹å³æ„å»º æ„å»ºå®Œæˆåç™»å½•åˆ°é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ï¼š docker login --username=xxx registry.cn-hangzhou.aliyuncs.com æ‹‰å–æ„å»ºå¥½çš„é•œåƒï¼šdocker pull registry.cn-hangzhou.aliyuncs.com/chengleqi/prometheus-operator:v0.49.0 è¿›è¡Œretagï¼šdocker tag registry.cn-hangzhou.aliyuncs.com/chengleqi/prometheus-operator:v0.49.0 quay.io/prometheus-operator/prometheus-operator:v0.49.0 åˆ é™¤ä¹‹å‰çš„é•œåƒï¼šdocker rmi registry.cn-hangzhou.aliyuncs.com/chengleqi/prometheus-operator:v0.49.0 brancz/kube-rbac-proxy:v0.11.0ä¹Ÿé‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œæ­¤æ—¶å°±æœ‰äº†kube-operatoræ‰€éœ€çš„é•œåƒã€‚ ä½¿ç”¨kind load docker-image quay.io/brancz/kube-rbac-proxy:v0.11.0 quay.io/prometheus-operator/prometheus-operator:v0.49.0 --name clusterå°†é•œåƒåŠ è½½è¿›kindé›†ç¾¤ï¼Œç„¶åprometheus-operator-75d9b475d9-f29g8è¿™ä¸ªpodå°±æ­£å¸¸è¿è¡Œäº†ã€‚ kube-operator-podå¤„äºRunningçŠ¶æ€\" kube-operator-podå¤„äºRunningçŠ¶æ€ è‹¥è¿˜æœ‰é•œåƒæŠ¥é”™ï¼Œé‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œç›´åˆ°æ‰€æœ‰podéƒ½å¤„äºRunningçŠ¶æ€ï¼Œåˆ°æ­¤kube-prometheuséƒ¨ç½²æˆåŠŸã€‚ ","date":"2021-08-05","objectID":"/posts/21-08-05/kube-prometheus/:2:0","tags":["Prometheus"],"title":"Kuberneteséƒ¨ç½²kube-prometheus","uri":"/posts/21-08-05/kube-prometheus/"},{"categories":["Kubernetes"],"content":"æµ‹è¯•kube-prometheus ","date":"2021-08-05","objectID":"/posts/21-08-05/kube-prometheus/:3:0","tags":["Prometheus"],"title":"Kuberneteséƒ¨ç½²kube-prometheus","uri":"/posts/21-08-05/kube-prometheus/"},{"categories":["Kubernetes"],"content":"Prometheus è¿™é‡Œè®¾ç½®serviceçš„ç«¯å£è½¬å‘ï¼Œæ¥ç€å°±èƒ½è¿›å…¥Prometheusçš„UIå°è¯•PromQLäº†ã€‚ kubectl --namespace monitoring port-forward svc/prometheus-k8s 9090 info ä¸€æœ¬Prometheusçš„ä¹¦ ","date":"2021-08-05","objectID":"/posts/21-08-05/kube-prometheus/:3:1","tags":["Prometheus"],"title":"Kuberneteséƒ¨ç½²kube-prometheus","uri":"/posts/21-08-05/kube-prometheus/"},{"categories":["Kubernetes"],"content":"grafana åŒæ ·ç«¯å£è½¬å‘ kubectl --namespace monitoring port-forward svc/grafana 3000 grafana login\" grafana login tip ç”¨æˆ·åå’Œå¯†ç éƒ½æ˜¯admin ä¹‹åå°±å¯ä»¥å°è¯•è‡ªå¸¦çš„é¢æ¿äº†(ä¾‹å¦‚node-exporter)ï¼š grafana node-exporter\" grafana node-exporter Grafanaä¸ä»…å¯ä»¥å¯¹æ¥Prometheusï¼Œè¿˜å¯ä»¥å¯¹æ¥zabbixç­‰å¾ˆå¤šæ•°æ®æºï¼Œæ˜¯ä¸€ä¸ªéå¸¸æ¼‚äº®å’Œå¥½ç”¨çš„å¯è§†åŒ–å·¥å…·ã€‚ info è¿˜æœ‰ä¸€ä¸ªè‡ªç§°Kubernetes IDEçš„å·¥å…·Lensï¼Œæˆ‘å°è¯•äº†ä¸€ä¸‹ï¼Œä¹Ÿå¾ˆå¥½ç”¨ã€‚ ","date":"2021-08-05","objectID":"/posts/21-08-05/kube-prometheus/:3:2","tags":["Prometheus"],"title":"Kuberneteséƒ¨ç½²kube-prometheus","uri":"/posts/21-08-05/kube-prometheus/"},{"categories":null,"content":"welcome amigo~ Tips è¿™é‡Œå¹¶æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿â˜• bye~ğŸŒ’ğŸœ ","date":"2021-08-03","objectID":"/about/:0:0","tags":null,"title":"About","uri":"/about/"},{"categories":["Hugo"],"content":"æ•ˆæœ åœ¨vscodeä¸­å†™ä½œï¼Œå†™å®Œç›´æ¥commit pushï¼Œå®Œæˆæ–‡ç« çš„å‘å¸ƒã€‚ ","date":"2021-08-01","objectID":"/posts/21-08-01/hugo/:1:0","tags":["Docker","CI/CD"],"title":"Docker+GitHub Actionsä¼˜åŒ–åšå®¢workflow","uri":"/posts/21-08-01/hugo/"},{"categories":["Hugo"],"content":"workflow å¦‚ä¸‹å›¾: workflow(ç‚¹å‡»å›¾ç‰‡è·³è½¬è‡³Live Editor) ä¸Šå›¾æ˜¯ç”¨mermaidç”»çš„ï¼Œflowchartæ˜¯mermaidé«˜ç‰ˆæœ¬çš„featureï¼Œåœ¨æˆ‘ä½¿ç”¨Feelitä¸»é¢˜shortcodeçš„æ—¶å€™è¿˜æ²¡æœ‰å¾—åˆ°æ”¯æŒï¼Œæäº†ä¸ªissueï¼Œåœ¨è¿™æ¬¡æ›´æ–°ä¸­å¾—åˆ°äº†æ”¯æŒã€‚ mermaid shortcodeåœ¨æ‰‹æœºæµè§ˆå™¨ä¸­æ²¡æœ‰å¾—åˆ°å¾ˆå¥½çš„æ”¯æŒï¼Œæ¢å›figure shortcodeã€‚(2021å¹´ 08æœˆ 04æ—¥ æ˜ŸæœŸä¸‰ 15:30:15 CST) ","date":"2021-08-01","objectID":"/posts/21-08-01/hugo/:2:0","tags":["Docker","CI/CD"],"title":"Docker+GitHub Actionsä¼˜åŒ–åšå®¢workflow","uri":"/posts/21-08-01/hugo/"},{"categories":["Hugo"],"content":"ä½¿ç”¨Dockerè¿›è¡Œæœ¬åœ°é¢„è§ˆ å‚è€ƒäº†jojomi/docker-hugoé‡å†™äº†Dockerfileå’Œæ„å»ºé•œåƒå¹¶ä¸”å¯åŠ¨å®¹å™¨çš„è„šæœ¬chengleqi/docker-hugoã€‚ é•œåƒçš„README åœ¨æµè§ˆå™¨ä¸­ä¸‹è½½æœ€æ–°ç‰ˆhugo binary(extendç‰ˆæœ¬) å°†ä¸‹è½½å¥½çš„hugo binaryæ”¾åœ¨é¡¹ç›®æ ¹ç›®å½• æ‰§è¡Œ./build_and_start_hugo.sh æ„å»ºé•œåƒå¹¶è¿è¡Œå®¹å™¨ æ‰“å¼€æµè§ˆå™¨ localhost:1313 æ³¨æ„ åœ¨docker runçš„æ—¶å€™æŒ‚è½½äº†blogç›®å½•ç”¨äºhugo serverï¼Œå¹¶æ·»åŠ äº†--rmå‚æ•°ï¼Œé€€å‡ºå®¹å™¨åç›´æ¥åˆ é™¤å®¹å™¨ã€‚ ","date":"2021-08-01","objectID":"/posts/21-08-01/hugo/:2:1","tags":["Docker","CI/CD"],"title":"Docker+GitHub Actionsä¼˜åŒ–åšå®¢workflow","uri":"/posts/21-08-01/hugo/"},{"categories":["Hugo"],"content":"ä½¿ç”¨GitHub Actionsè‡ªåŠ¨æ„å»ºå¹¶éƒ¨ç½² æ­¤å¤„å‚è€ƒäº†Arnab Kumar Shilçš„æ–‡ç« ã€‚é…ç½®äº†GitHub Actionsçš„æµæ°´çº¿ã€‚è„šæœ¬å¦‚ä¸‹: name:github pageson:push:branches:- main # Set a branch to deploypull_request:jobs:deploy:runs-on:ubuntu-20.04steps:- uses:actions/checkout@v2with:submodules:true# Fetch Hugo themes (true OR recursive)fetch-depth:0# Fetch all history for .GitInfo and .Lastmod- name:Setup Hugouses:peaceiris/actions-hugo@v2with:hugo-version:'latest'extended:true- name:Buildrun:hugo --minify- name:Deployuses:peaceiris/actions-gh-pages@v3if:github.ref == 'refs/heads/main'with:personal_token:${{ secrets.ACTION_ACCESS_TOKEN }}external_repository:chengleqi/chengleqi.github.iopublish_branch:mainpublish_dir:./publiccname:chengleqi.comè¿™ä¸ªè„šæœ¬ä½¿ç”¨äº†peaceiris/actions-hugo@v2å’Œpeaceiris/actions-gh-pages@v3ä¸¤ä¸ªactionåˆ†åˆ«ç”¨äºè®¾ç½®hugoç¯å¢ƒä»¥åŠæ¨é€è‡³gh-pagesã€‚ æŠ€å·§ å­˜å‚¨blogæºæ–‡ä»¶çš„repoè®¿é—®github.io repoéœ€è¦è®¾ç½®personal_token: ${{ secrets.ACTION_ACCESS_TOKEN }} åœ¨Deploy jobä¸­éœ€è¦æŒ‡å®šCNAMEï¼Œä¼šè‡ªåŠ¨ç”ŸæˆCNAMEæ–‡ä»¶ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ·»åŠ ï¼Œå‚è€ƒHugoå®˜ç½‘ã€‚ ","date":"2021-08-01","objectID":"/posts/21-08-01/hugo/:2:2","tags":["Docker","CI/CD"],"title":"Docker+GitHub Actionsä¼˜åŒ–åšå®¢workflow","uri":"/posts/21-08-01/hugo/"},{"categories":["Hugo"],"content":"å¯ç”¨algoliaæœç´¢ å› ä¸ºalgoliaéœ€è¦ä¸Šä¼ ç´¢å¼•æ–‡ä»¶ï¼Œä¸»é¢˜çš„ä½œè€…æ¨èäº†ä¸€æ¬¾Algolia Atomicæ’ä»¶ç”¨æ¥å®Œæˆè‡ªåŠ¨åŒ–ä¸Šä¼ ã€‚ è¿™æ¬¾æ’ä»¶éœ€è¦nodeå’Œnpmï¼Œæˆ‘å‚è€ƒäº†è¿™ç¯‡æ–‡ç« ï¼Œç›´æ¥åœ¨GitHub Actionsåˆ†é…çš„VPSä¸­é…ç½®ä¸æˆåŠŸã€‚ äºæ˜¯æ‰¾åˆ°äº†è¿™ä¸ªæ–¹æ¡ˆï¼Œä½œè€…å°†atomic-algoliaå°è£…è¿›dockerå®¹å™¨ä¸­ï¼Œå¯åŠ¨ç«‹å³æ‰§è¡Œatomic-alogliaã€‚å°†dockerå¯åŠ¨å‘½ä»¤é™„åŠ åˆ°pipelineè„šæœ¬ä¸­ï¼Œå†æ¬¡æ¨é€ï¼Œä¸€æ¬¡æˆåŠŸï¼Œåªæ˜¯å¤šå‡ºäº†æ‹‰å–é•œåƒçš„æ—¶é—´ã€‚æˆ‘å·²å°†é•œåƒåŒæ­¥è‡³Docker Hubè¿›è¡Œè§£è€¦ã€‚ ","date":"2021-08-01","objectID":"/posts/21-08-01/hugo/:2:3","tags":["Docker","CI/CD"],"title":"Docker+GitHub Actionsä¼˜åŒ–åšå®¢workflow","uri":"/posts/21-08-01/hugo/"}]